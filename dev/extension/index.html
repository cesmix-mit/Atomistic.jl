<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implementing the Atomistic API · Atomistic.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://cesmix-mit.github.io/Atomistic.jl/extension/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Atomistic.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Implementing the Atomistic API</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Molecular-Dynamics-Simulators"><span>Molecular Dynamics Simulators</span></a></li><li class="toplevel"><a class="tocitem" href="#MolecularDynamicsResult_Specification"><span>Molecular Dynamics Results</span></a></li><li><a class="tocitem" href="#Simulation-Configuration-Functions"><span>Simulation Configuration Functions</span></a></li><li><a class="tocitem" href="#Time-Dependent-System-Data"><span>Time-Dependent System Data</span></a></li><li><a class="tocitem" href="#Simulation-Analysis"><span>Simulation Analysis</span></a></li></ul></li><li><a class="tocitem" href="../usage/">Using Atomistic-Compatible Packages</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Implementing the Atomistic API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implementing the Atomistic API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cesmix-mit/Atomistic.jl/blob/master/docs/src/extension.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Implementing-the-Atomistic-API"><a class="docs-heading-anchor" href="#Implementing-the-Atomistic-API">Implementing the Atomistic API</a><a id="Implementing-the-Atomistic-API-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-the-Atomistic-API" title="Permalink"></a></h1><p>There are two main parts to the Atomistic API. An implementer must provide a concrete simulator type subtyping <code>MolecularDynamicsSimulator</code> and a concrete result type subtyping <code>MolecularDynamicsResult</code>. A summary of the required functionality for each component follows.</p><h1 id="Molecular-Dynamics-Simulators"><a class="docs-heading-anchor" href="#Molecular-Dynamics-Simulators">Molecular Dynamics Simulators</a><a id="Molecular-Dynamics-Simulators-1"></a><a class="docs-heading-anchor-permalink" href="#Molecular-Dynamics-Simulators" title="Permalink"></a></h1><p>The only function that must be implemented for subtypes of <code>MolecularDynamicsSimulator</code> is a method of <code>simulate</code>.</p><pre><code class="language-julia hljs">simulate(system::AbstractSystem, simulator::MolecularDynamicsSimulator, potential::ArbitraryPotential)::MolecularDynamicsResult</code></pre><p>The first parameter is an instance of an implementation of the <code>AbstractSystem</code> interface defined by <a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase.jl</a>. It is important that the implementer rely only on the general API rather than any specific implementation details because the user could provide any system implementation; if there are performance-sensitive decisions based on the system type, this should be achieved through multiple dispatch. The species, position, and velocity of each body as well as the boundary shape and conditions are stored in this data structure. An implementer should take special care to handle units appropriately when converting from this representation to the internal representation of the underlying simulator package.</p><p>The second parameter is the custom simulator. This could specify information such as the duration of the simulation, numerical details such as discretization parameters and integration methods, or domain specific options such as thermostats and barostats.</p><p>The third parameter is an instance of an implementation of the <code>ArbitraryPotential</code> interface defined by <a href="https://github.com/cesmix-mit/InteratomicPotentials.jl">InteratomicPotentials.jl</a>. The main function from this interface that is useful in the dynamics context is <code>InteratomicPotentials.force(s::AbstractSystem, p::ArbitraryPotential)::AbstractVector{StaticVector{3, Real}}</code>. However, it is recommended that implementers consider using <code>InteratomicPotentials.energy_and_force(s::AbstractSystem, p::ArbitraryPotential)::NamedTuple{(:e, :f), Tuple{Real, Vector{SVector{3, Real}}}}</code> and cache the energy results on the <code>MolecularDynamicsResult</code> struct because the additional energy calculation is asymptotically free for most interatomic potential implementations. See the discussion of the <code>potential_energy</code> function below.</p><p>The <code>simulate</code> method should return the corresponding implementation of the <code>MolecularDynamicsResult</code> interface as described below.</p><h1 id="MolecularDynamicsResult_Specification"><a class="docs-heading-anchor" href="#MolecularDynamicsResult_Specification">Molecular Dynamics Results</a><a id="MolecularDynamicsResult_Specification-1"></a><a class="docs-heading-anchor-permalink" href="#MolecularDynamicsResult_Specification" title="Permalink"></a></h1><p>Fifteen total functions must be implemented for subtypes of <code>MolecularDynamicsResult</code>, four of which have default implementations. The functions allow users to access simulation data from three categories: simulation configuration, time-dependent system data, and simulation analysis.</p><h2 id="Simulation-Configuration-Functions"><a class="docs-heading-anchor" href="#Simulation-Configuration-Functions">Simulation Configuration Functions</a><a id="Simulation-Configuration-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Configuration-Functions" title="Permalink"></a></h2><p>There are five functions in the <code>MolecularDynamicsResult</code> API which return time-independent simulation configuration information:</p><pre><code class="language-julia hljs">get_time_range(result::MolecularDynamicsResult)::AbstractVector{Unitful.Time}</code></pre><p>This function should return a unit-anotated vector containing the time value for each step of the simulation which can be iterated for plotting, animation, or other analysis.</p><pre><code class="language-julia hljs">get_num_bodies(result::MolecularDynamicsResult)::Integer</code></pre><p>This function should return the numebr of bodies in the simulation.</p><pre><code class="language-julia hljs">get_bounding_box(result::MolecularDynamicsResult)::SVector{3, SVector{3, Unitful.Length}}</code></pre><p>This function should return the <a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase.jl</a>-style bounding box of the system used in the simulation.</p><pre><code class="language-julia hljs">get_boundary_conditions(result::MolecularDynamicsResult)::SVector{3, BoundaryCondition}</code></pre><p>This function should return the <a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase.jl</a>-style boundary conditions of the system used in the simulation.</p><pre><code class="language-julia hljs">reference_temperature(result::MolecularDynamicsResult)::Union{Unitful.Temperature,Missing}</code></pre><p>This function should return a unit-anotated temperature that describes the temperature maintained by the thermostat used in the simulation. If there is no reference temperature for the particular simulation, the function should return missing, which is the default implementation.</p><h2 id="Time-Dependent-System-Data"><a class="docs-heading-anchor" href="#Time-Dependent-System-Data">Time-Dependent System Data</a><a id="Time-Dependent-System-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Dependent-System-Data" title="Permalink"></a></h2><p>There are five functions in the <code>MolecularDynamicsResult</code> API which return system data at a particular timestep, two of which have default implementations.</p><pre><code class="language-julia hljs">get_time(result::MolecularDynamicsResult, t::Integer)::Unitful.Time</code></pre><p>This convenience function converts a timestep to the unit-annotated time of the timestep using the provided <code>get_time_range</code> implementation. The timestep defaults to the end of the simulation when <code>t</code> is not passed. Most implementers will not need to write a custom implementation.</p><pre><code class="language-julia hljs">get_positions(result::MolecularDynamicsResult, t::Integer)::AbstractVector{SVector{3, Unitful.Length}}</code></pre><p>This function should return the unit-annotated position of each particle in the system at a particular timestep from the simulation result. The returned positions should be normalized such that they lie within the bounding box of the system, even if the system is periodic. The timestep defaults to the end of the simulation when <code>t</code> is not passed.</p><pre><code class="language-julia hljs">get_velocities(result::MolecularDynamicsResult, t::Integer)::AbstractVector{SVector{3, Unitful.Velocity}}</code></pre><p>This function should return the unit-annotated velocities of each particle in the system at a particular timestep from the simulation result. The timestep defaults to the end of the simulation when <code>t</code> is not passed.</p><pre><code class="language-julia hljs">get_particles(result::MolecularDynamicsResult, t::Integer)::AbstractVector{Atom}</code></pre><p>This function should return the particles in the system at a particular timestep from the simulation result. The timestep defaults to the end of the simulation when <code>t</code> is not passed. It is important for any <code>Atom</code> metadata passed in on the input system be preserved when reproducing the particles as some interatomic potential implementations may depend on this data for correctness or performance.</p><pre><code class="language-julia hljs">get_system(result::MolecularDynamicsResult, t::Integer)::AbstractSystem</code></pre><p>This function should return an <a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase.jl</a> <code>AbstractSystem</code> which captures the system at a particular timestep in the simulation. The timestep defaults to the end of the simulation when <code>t</code> is not passed.</p><p>The default implementation creates a <code>FlexibleSystem</code> by combining the provided implementations of <code>get_particles</code>, <code>get_bounding_box</code>, and <code>get_boundary_conditions</code>.</p><h2 id="Simulation-Analysis"><a class="docs-heading-anchor" href="#Simulation-Analysis">Simulation Analysis</a><a id="Simulation-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Analysis" title="Permalink"></a></h2><pre><code class="language-julia hljs">temperature(result::MolecularDynamicsResult, t::Integer)::Unitful.Temperature</code></pre><p>This function should return a unit-anotated temperature for the system at a particular timestep in the simulation. The timestep defaults to the end of the simulation when <code>t</code> is not passed.</p><pre><code class="language-julia hljs">kinetic_energy(result::MolecularDynamicsResult, t::Integer)::Unitful.Energy</code></pre><p>This function should return a unit-anotated kinetic energy for the system at a particular timestep in the simulation. The timestep defaults to the end of the simulation when <code>t</code> is not passed.</p><pre><code class="language-julia hljs">potential_energy(result::MolecularDynamicsResult, t::Integer)::Unitful.Energy</code></pre><p>This function should return a unit-anotated potential energy for the system at a particular timestep in the simulation. The timestep defaults to the end of the simulation when <code>t</code> is not passed. If potential energy values were not cached at simulation time, the relevant function from the <a href="https://github.com/cesmix-mit/InteratomicPotentials.jl">InteratomicPotentials.jl</a> interface is <code>InteratomicPotentials.potential_energy(a::AbstractSystem, p::ArbitraryPotential)::Real</code>.</p><pre><code class="language-julia hljs">total_energy(result::MolecularDynamicsResult, t::Integer)::Unitful.Energy</code></pre><p>This function should return a unit-anotated total energy for the system at a particular timestep in the simulation. The timestep defaults to the end of the simulation when <code>t</code> is not passed.</p><p>The default implementation simply sums the kinetic and potential energy functions, but an implementor of the API might provide a custom implementation if there is a more direct means of calculation provided by the underlying simulator.</p><pre><code class="language-julia hljs">rdf(result::MolecularDynamicsResult, start::Integer, stop::Integer)::Tuple{AbstractVector{Real},AbstractVector{Real}}</code></pre><p>This function should calculate the <a href="https://en.wikipedia.org/wiki/Radial_distribution_function">radial distribution function</a> of the system averaged across a range of timesteps. It should return a named tuple of vectors:</p><ul><li>r: unit-annotated interparticle radial distance bins</li><li>g: distribution value of each bin</li></ul><p>The default implementation provided uses the provided implementations of <code>get_num_bodies</code>, <code>get_bounding_box</code>, <code>get_boundary_conditions</code>, and <code>get_positions</code>. An implementor of the API could use a built in implementation if one that fits this spec is available.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../usage/">Using Atomistic-Compatible Packages »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Tuesday 8 February 2022 19:48">Tuesday 8 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
